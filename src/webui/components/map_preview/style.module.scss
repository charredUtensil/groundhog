.cavernPreview {
  position: absolute;
  overflow: hidden;
  width: 100%;
  height: 100%;

  --pvw-bpak: #222222;
  --pvw-bpck: #2D004B;
  --pvw-bphk: #166921;
  --pvw-pathspan: yellow;
  --pvw-pathaux: #24b136;
  --pvw-entfriend: yellow;
  --pvw-entenemy: red;
  --pvw-dfluid: #080022;
  --pvw-dfloor: #180032;
  --pvw-dwall: #2D004B;
  --pvw-scale0: #555544;
  --pvw-scale1: #777744;
  --pvw-scale2: #999944;
  --pvw-scale3: #bbbb44;
  --pvw-scale4: #dddd44;
  --pvw-scale5: #ffff44;
  --pvw-scale6: #ffff66;
  --pvw-scale7: #ffff88;
  --pvw-tile1: #2D004B;
  --pvw-tile2: #180032;
  --pvw-tile3: #180032;
  --pvw-tile4: #180032;
  --pvw-tile5: #180032;
  --pvw-tile6: #FF5A00;
  --pvw-tile11: #002FB5;
  --pvw-tile12: #166921;
  --pvw-tile14: #BFBFBF;
  --pvw-tile24: #9D9B00;
  --pvw-tile26: #AD59EF;
  --pvw-tile30: #943CC3;
  --pvw-tile34: #731CAD;
  --pvw-tile38: #800080;
  --pvw-tile42: #B5FF00;
  --pvw-tile46: #9C4108;
  --pvw-tile50: #FFFF00;
  --pvw-tile60: #180032;
  --pvw-tile61: #180032;
  --pvw-tile62: #180032;
  --pvw-tile63: #180032;
  --pvw-disco0: #ffff44;
  --pvw-disco1: #882222;
  --pvw-oxex: #555533;
  --pvw-oxhc: var(--pvw-tile42);

  .map {
    position: absolute;

    .baseplate {
      font-family: var(--font-tiny);
      font-size: 8px;

      .fg {
        fill: white;
      }

      &.stockKind .bg {
        stroke: blue;
      }

      &.ambiguousKind .bg {
        fill: var(--pvw-bpak);
      }

      &.caveKind .bg {
        fill: var(--pvw-bpck);
      }

      &.hallKind .bg {
        fill: var(--pvw-bphk);
      }
    }

    .path {
      stroke-linecap: round;
      stroke-dasharray: 2, 3;

      &.ambiguousKind {
        --fg-color: white;
        --fg-opacity: 0.3;
      }

      &.spanningKind {
        --fg-color: var(--pvw-pathspan);
      }

      &.auxiliaryKind {
        --fg-color: var(--pvw-pathaux);
      }

      & > path {
        stroke: var(--fg-color);
        stroke-opacity: var(--fg-opacity);
        stroke-width: 2px;
      }

      & > text {
        fill: var(--fg-color);
        opacity: var(--fg-opacity);
        font-family: var(--font-tiny);
        font-size: 12px;
      }
    }

    .plan {
      --color-bg: #444444;
      --color-fg: white;

      &.caveKind .bg {
        stroke: var(--color-bg);
        stroke-width: 2px;
        fill: none;
      }
      &.hallKind .bg {
        stroke: var(--color-bg);
        stroke-linecap: round;
        opacity: 0.4;
      }
      &.fluid6 {
        --color-bg: var(--pvw-tile6);
      }
      &.fluid11 {
        --color-bg: var(--pvw-tile11);
      }
      .fg {
        text-anchor: middle;
        fill: var(--color-fg);
        font-family: "Silkscreen";
        font-size: 8px;
        stroke: black;
        stroke-width: 0.2;
      }
    }

    .pearl {
      &.innerPearl {
        stroke-width: 1px;
        &.caveKind {
          --color0: #40ffff;
          --color1: #40dddd;
          --color2: #40bbbb;
          --color3: #409999;
        }
        &.hallKind {
          --color0: #ffff20;
          --color1: #dddd20;
          --color2: #bbbb20;
          --color3: #999920;
        }
      }
      &.outerPearl {
        stroke-width: 0.5px;
        --color0: #999999;
        --color1: #888888;
        --color2: #777777;
        --color3: #666666;
      }
      .layer {
        &.layer0 {
          stroke: var(--color0);
        }
        &.layer1 {
          stroke: var(--color1);
        }
        &.layer2 {
          stroke: var(--color2);
        }
        &.layer3 {
          stroke: var(--color3);
        }
      }
    }

    .tiles {
      shape-rendering: crispEdges;

      .bounds {
        fill: none;
      }

      &.oly-entities, &.oly-tiles {
        .bounds {
          fill: var(--pvw-tile38);
        }
      }
    }

    .height {
      shape-rendering: crispEdges;
    }

    .entity {
      --color-fg: var(--pvw-entfriend);
      &.enemy {
        --color-fg: var(--pvw-entenemy);
      }
      .marker {
        fill: var(--color-fg);
        stroke: black;
        stroke-width: 0.5px;
      }
      .label {
        fill: black;
        font-family: "Outfit";
        font-size: 2px;
        text-anchor: middle;
      }
    }

    .openCaveFlag {
      stroke: red;
      fill: white;
    }
  }

  .stats {
    position: absolute;
    left: 0;
    bottom: 0;
    color: var(--palette-accent);
    background: var(--palette-bg);
    font-family: var(--font-tiny);
    font-size: 8px;
    max-width: 400px;
    border: 1px solid var(--palette-lines);
    padding: 4px 14px;
    margin: 16px;

    > ul {
      padding: 0;

      > li {
        display: inline;

        &:not(:first-child) {
          padding-left: 16px;
        }
      }
    }
  }

  .error {
    position: absolute;
    left: 0;
    right: 0;
    top: 50%;
    font-size: 24px;
    color: #f18686;
    font-family: var(--font-body);
    text-align: center;
    line-break: anywhere;
  }
}
